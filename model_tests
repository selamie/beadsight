from clip_pretraining import modified_resnet18, get_beadsight_clip
import torch
import torch.nn as nn


bwts = torch.load("/media/selamg/DATA/beadsight/data/clipmodels/0/epoch_0_beadsight_encoder.pth")
# bwts = torch.load("/media/selamg/DATA/beadsight/data/clipmodels/0/epoch_0_beadsight_projection.pth")

beadsight_encoder = get_beadsight_clip()
beadsight_encoder.load_state_dict(bwts)
beadsight_encoder = nn.Sequential(beadsight_encoder,nn.AdaptiveAvgPool2d(output_size=1), nn.Flatten())

print("encoder loaded")